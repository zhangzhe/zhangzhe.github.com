
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
   <meta http-equiv="content-type" content="text/html; charset=utf-8" />
   <title>solve 'single table inheritance' problem with view</title>
   <meta name="author" content="zhangzhe" />
   <!-- syntax highlighting CSS -->
   <link rel="stylesheet" href="/assets/themes/tom/css/syntax.css" type="text/css" />

   <!-- Homepage CSS -->
   <link rel="stylesheet" href="/assets/themes/tom/css/screen.css" type="text/css" media="screen, projection" />

   <!-- Typekit -->
   <script type="text/javascript" src="http://use.typekit.com/jpd0pfm.js"></script>
   <script type="text/javascript">try{Typekit.load();}catch(e){}</script>
</head>
<body>

  <div class="site">
    <div class="title">
      <a href="/">Keep simple & live Strong</a>
      <a class="extra" href="/pages.html">Pages</a>
      <a class="extra" href="/archive.html">Archive</a>
      <a class="extra" href="/categories.html">Categories</a>
      <a class="extra" href="/tags.html">Tags</a>
    </div>

    
<div id="post">
  <h1>solve 'single table inheritance' problem with view</h1>
  <p class="meta">
    27 April 2010
    
  </p>
  <p>I want to read data cross database, so I create a model page_group.rb and code like:</p>

<div class="highlight"><pre><code class="ruby"><span class="k">class</span> <span class="nc">PageGroup</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span>
  <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span><span class="o">.</span><span class="n">establish_connection</span><span class="p">(</span>
    <span class="ss">:adapter</span>  <span class="o">=&gt;</span> <span class="s2">&quot;mysql&quot;</span><span class="p">,</span>
    <span class="ss">:host</span>     <span class="o">=&gt;</span> <span class="s2">&quot;localhost&quot;</span><span class="p">,</span>
    <span class="ss">:username</span> <span class="o">=&gt;</span> <span class="s2">&quot;myuser&quot;</span><span class="p">,</span>
    <span class="ss">:password</span> <span class="o">=&gt;</span> <span class="s2">&quot;mypass&quot;</span><span class="p">,</span>
    <span class="ss">:database</span> <span class="o">=&gt;</span> <span class="s2">&quot;somedatabase&quot;</span>
  <span class="p">)</span>
<span class="k">end</span>
</code></pre>
</div>


<p>If PageGroup model in source app use single-table inheritance, then in console: <br>
<code>PageGroup.first</code></p>

<p>will got error:</p>

<hr />

<pre><code>ActiveRecord::SubclassNotFound: The single-table inheritance mechanism 
failed to locate the subclass: 'sss'. This error is raised because the
column 'type' is reserved for storing the class in case of inheritance.
Please rename this column if you didn't intend it to be used for 
storing the inheritance class or overwrite PageGroup.inheritance_column 
to use another column for that information.
</code></pre>

<p>Solution is create view for the table use single-table inheritance(PageGroup) in source app:</p>

<div class="highlight"><pre><code class="ruby"><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;CREATE VIEW extra_lessons AS SELECT id, title, blabla FROM page_groups&quot;</span><span class="p">)</span>  
</code></pre>
</div>


<p>solved:)</p>

</div>
<br>
<hr>

<br>
<br>
<h1>版权声明：</h1>
<p>
  <a rel="licence" href="http://creativecommons.org/licenses/by-nc-nd/2.5/cn/"
  target="_blank"><img src="http://i.creativecommons.org/l/by-nc-nd/2.5/cn/88x31.png"/></a>
</p>


<p>
  本文采用 <a href="http://creativecommons.org/licenses/by-nc-nd/2.5/cn/"
  target="_blank" rel="licence">知识共享 署名-非商业性使用-禁止演绎 2.5 中国大陆(CC-BY-NC-ND)</a> 授权，任何形式的转载均需加入本授权协议链接（或文本）以及指向本站的链接。<br>
  协议地址：http://creativecommons.org/licenses/by-nc-nd/2.5/cn/legalcode<br>
</p>
<br>

<div id="related">
  <h2>Related Posts</h2>
  <ul class="posts">
    
      <li><span>16 Dec 2012</span> &raquo; <a href="/2012/12/16/theory-to-real-life">理论到实践的距离</a></li>
    
      <li><span>09 Dec 2012</span> &raquo; <a href="/Journal/2012/12/09/sunflower-seed-theory">嗑瓜子理论</a></li>
    
      <li><span>25 Nov 2012</span> &raquo; <a href="/Journal/2012/11/25/my-fourth-marathon">记我的第四次马拉松</a></li>
    
  </ul>
</div>












    <div class="footer">
      <div class="contact">
        <p>
          <a href='mailto:gary.zzhang@gmail.com'>gary.zzhang@gmail.com</a>
        </p>
      </div>
      <div class="contact">
        <p>
          <a href="http://github.com/zhangzhe/">github.com/zhangzhe</a><br />
        </p>
      </div>
    </div>
  </div>
  <a href="http://github.com/zhangzhe"><img style="position: absolute; top: 0; right: 0; border: 0;" src="http://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png" alt="Fork me on GitHub" /></a>
  
</body>
</html>

