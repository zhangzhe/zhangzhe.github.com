
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
   <meta http-equiv="content-type" content="text/html; charset=utf-8" />
   <title>my rails test environment</title>
   <meta name="author" content="zhangzhe" />
   <!-- syntax highlighting CSS -->
   <link rel="stylesheet" href="/assets/themes/tom/css/syntax.css" type="text/css" />

   <!-- Homepage CSS -->
   <link rel="stylesheet" href="/assets/themes/tom/css/screen.css" type="text/css" media="screen, projection" />

   <!-- Typekit -->
   <script type="text/javascript" src="http://use.typekit.com/jpd0pfm.js"></script>
   <script type="text/javascript">try{Typekit.load();}catch(e){}</script>
</head>
<body>

  <div class="site">
    <div class="title">
      <a href="/">Keep simple & live Strong</a>
      <a class="extra" href="/pages.html">Pages</a>
      <a class="extra" href="/archive.html">Archive</a>
      <a class="extra" href="/categories.html">Categories</a>
      <a class="extra" href="/tags.html">Tags</a>
    </div>

    
<div id="post">
  <h1>my rails test environment</h1>
  <p class="meta">
    20 May 2010
    
  </p>
  <p>Rspec and TDD are great.
Would like to share my configuration and some experience, enjoy:)</p>

<p><strong>1.generate test doc</strong><br></p>

<p>use params <code>--format specdoc</code> will output test doc in term</p>

<div class="highlight"><pre><code class="ruby"><span class="n">spec</span> <span class="n">spec</span><span class="o">/</span><span class="n">models</span><span class="o">/</span><span class="n">blog_spec</span><span class="o">.</span><span class="n">rb</span> <span class="o">--</span><span class="nb">format</span> <span class="n">specdoc</span>
</code></pre>
</div>


<p>Also can output test doc for all tests using commend<br>
<code>rake spec:doc</code></p>

<p>But my favourite way is use <code>--format html</code> to output doc into a html file<br>
<code>spec spec/models/blog_spec.rb --format html:test.html</code></p>

<p>When code coverage and organization are good enough, this doc even can use as documentation for code.</p>

<p>A more convenient way is automate generate this doc after test or rcov, detail see 4 bellow.</p>

<p><strong>2.generate code coverage</strong><br></p>

<hr />

<pre><code>rcov 
rake spec:rcov
</code></pre>

<p>will generate html format [green]code coverage[/green].</p>

<p><code>spec:rcov</code> by default will generate code coverage for all code under app/ and /lib, even there is no test file for them. It is not good in some condition, we can config <code>spec/rcov.opts</code> to change this.
Just generate code coverage for models: <br>
<code>--exclude "spec/*,gems/*,app/controllers/*,app/helpers/*,app/sweepers/*,app/workers/*,lib/*"</code></p>

<br>


<p>Code coverage is great way for checking the quality of code, but 100% coverage does not mean your code is perfect. As says in The Rspec Book:
[green]So while low code coverage is a clear indicator that your specs need some work, high coverage does not necessarily indicate that everything is honky-dory.[/green]</p>

<p><strong>3.rspec options</strong><br></p>

<p>most useful options for me</p>

<hr />

<pre><code>--colour                               Show coloured (red/green) output
--format o                           Specifies format for output: Profiling of 10 slowest examples
--format html:test.html        Specifies format for output: A nice HTML report
--diff                                   Show diff of objects that are expected to be equal when they are not
--help                                  Help
</code></pre>

<p>All options are asstable, for example<br>
<code>spec spec/models/formatable_string_spec.rb --format specdoc --color</code></p>

<p><strong>4.opts</strong><br></p>

<p>Do not need to add options every time when test, just do configuration to spec/spec.opts</p>

<hr />

<pre><code>--colour                     
--format html:test.html  
--diff
</code></pre>

<p>Combine the way of "generating test doc" in  1, add <code>--format html:test.html</code> to <code>spec/spec.opts</code> , will automate generate test doc after each test or rcov , the doc will output into test.html.</p>

<p><strong>5.Autotest</strong><br></p>

<p>Autotest is very cleaver, every time you save a test file, autotest will run that test file; and every time you save a library file, autotest will run the corresponding test file. If it sees that the previous failures are now passing, it loads up the entire suite and runs all of the examples again.
When tried autotest on company project, there was a problem. Solution see solve autotest always rerun problem.</p>

<hr>


<p>Test is good, but as says in Code Complete: <br>
Even considering the numerous kinds of testing available, testing is only one part of a good software-quality program. High-quality development methods, including minimizing defects in requirements and design, are at least as important.</p>

<p><strong>Do not excessive relay on test.</strong></p>

</div>
<br>
<hr>

<br>
<br>
<h1>版权声明：</h1>
<p>
  <a rel="licence" href="http://creativecommons.org/licenses/by-nc-nd/2.5/cn/"
  target="_blank"><img src="http://i.creativecommons.org/l/by-nc-nd/2.5/cn/88x31.png"/></a>
</p>


<p>
  本文采用 <a href="http://creativecommons.org/licenses/by-nc-nd/2.5/cn/"
  target="_blank" rel="licence">知识共享 署名-非商业性使用-禁止演绎 2.5 中国大陆(CC-BY-NC-ND)</a> 授权，任何形式的转载均需加入本授权协议链接（或文本）以及指向本站的链接。<br>
  协议地址：http://creativecommons.org/licenses/by-nc-nd/2.5/cn/legalcode<br>
</p>
<br>

<div id="related">
  <h2>Related Posts</h2>
  <ul class="posts">
    
      <li><span>16 Dec 2012</span> &raquo; <a href="/2012/12/16/theory-to-real-life">理论到实践的距离</a></li>
    
      <li><span>09 Dec 2012</span> &raquo; <a href="/Journal/2012/12/09/sunflower-seed-theory">嗑瓜子理论</a></li>
    
      <li><span>25 Nov 2012</span> &raquo; <a href="/Journal/2012/11/25/my-fourth-marathon">记我的第四次马拉松</a></li>
    
  </ul>
</div>












    <div class="footer">
      <div class="contact">
        <p>
          <a href='mailto:gary.zzhang@gmail.com'>gary.zzhang@gmail.com</a>
        </p>
      </div>
      <div class="contact">
        <p>
          <a href="http://github.com/zhangzhe/">github.com/zhangzhe</a><br />
        </p>
      </div>
    </div>
  </div>
  <a href="http://github.com/zhangzhe"><img style="position: absolute; top: 0; right: 0; border: 0;" src="http://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png" alt="Fork me on GitHub" /></a>
  
</body>
</html>

